<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>Forum</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="ion-padding">
  <!-- New Post Input -->
  <ion-item class="new-post-input">
    <ion-icon name="person-circle-outline" slot="start"></ion-icon>
    <ion-textarea [(ngModel)]="newPostContent" placeholder="Write something..." auto-grow="true"></ion-textarea>
  </ion-item>
  <ion-button expand="block" class="add-post" (click)="addPost()">Post</ion-button>

  <!-- Display Posts -->
  <div class="post-list">
    <ion-card *ngFor="let post of posts" class="post-card">
      <ion-card-header>
        <ion-icon name="person-circle-outline" slot="start"></ion-icon>
        <ion-card-title>{{ post.name }}</ion-card-title>
        <ion-card-subtitle>Posted {{ post.timestamp }}</ion-card-subtitle>
      </ion-card-header>

      <ion-card-content>
        <p>{{ post.content }}</p>
      </ion-card-content>

      <!-- Post Actions -->
      <ion-item lines="none" class="post-actions">
        <ion-icon name="thumbs-up-outline" (click)="likePost(post)"></ion-icon>
        <ion-label class="option">Like ({{ post.likes }})</ion-label>

        <!-- Comment Toggle Button -->
        <ion-icon name="chatbubble-outline" (click)="toggleComments(post)"></ion-icon>
        <ion-label class="option">Comments</ion-label>
      </ion-item>

      <!-- Comments Section -->
      <div *ngIf="post.showComments">
        <ion-list>
          <ion-item lines="none" class="comment-item" *ngFor="let comment of post.comments">
            <ion-icon name="person-circle-outline" slot="start"></ion-icon>
            <ion-label>
              <h3>{{ comment.name }}</h3>
              <p>{{ comment.content }}</p>
            </ion-label>
          </ion-item>
        </ion-list>

        <!-- New Comment Input -->
        <ion-item class="new-comment-input">
          <ion-icon name="person-circle-outline" slot="start"></ion-icon>
          <ion-textarea #commentInput placeholder="Write a comment..." auto-grow="true"></ion-textarea>
          <ion-button
            slot="end"
            (click)="addComment(post, commentInput.value || ''); commentInput.value = '';"
            [disabled]="!commentInput.value || commentInput.value.trim() === ''"
          >
            Post
          </ion-button>
        </ion-item>
      </div>
    </ion-card>
  </div>
</ion-content>
